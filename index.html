<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css" />
    <title>gifTastic</title>

</head>

<body>
    <div class="container">
        <h1>gifTastic!</h1>
        <label for="search-field">Add a TV Show: </label>
        <input type="text" id="search-field">
        <input id="find-giphy" class="btn-primary" type="submit" value="giphy Search">
        <div class="show-buttons"></div>
        <div class="show-gifs"></div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">


        var topics = ["boardwalk empire", "sopranos", "the wire", "billions", "entourage", "dexter", "breaking bad", "better call saul", "dark", "black mirror",]
        var baseURL = "http://api.giphy.com/v1/gifs/search?q="
        var apiKey = "Yz4pO4lJDaMYGIX80M9gc2Mq7HKKS2or"

        $("#find-giphy").on("click", function () {
            var input = $("#search-field").val();
            var button = $("<button>").text(input);
            button.addClass("btn-primary");
            topics.push(input)
            $(".show-buttons").append(button);
        })


        for (var e = 0; e < topics.length; e++) {
            var button = $("<button>").text(topics[e]);
            button.addClass("btn-primary");
            $(".show-buttons").append(button);

            button.on("click", function () {
                var input = $(this).html()
                console.log(this)
                var queryURL = baseURL + input + "&api_key=" + apiKey + "&limit=10";
                $.ajax({
                    url: queryURL,
                    method: "GET"
                }).then(function (response) {
                    console.log(response.data);
                    console.log(queryURL);
                    var results = response.data;

                    for (i = 0; i < results.length; i++) {

                        var showDiv = $("<div>");
                        var rating = $("<p>").text("Rating: " + results[i].rating)
                        var image = $("<img>")
                        var imgURL = results[i].images.original.url
                        var showImage = image.attr("src", imgURL)

                        showDiv.append(showImage)
                        showDiv.append(rating)
                        $(".show-gifs").prepend(showDiv)
                    }
                });
            });

        }




        // $("#find-giphy").on("click", function () {
        //     var input = $("#search-field").val();
        //     var queryURL = baseURL + input + "&api_key=" + apiKey + "&limit=10";
        //     $.ajax({
        //         url: queryURL,
        //         method: "GET"
        //     }).then(function (response) {
        //         console.log(response.data);
        //         console.log(queryURL);
        //         var results = response.data;

        //         // create a button from the user input 
        //         var button = $("<button>").text(input);

        //         // add a bootstrap class
        //         button.addClass("btn-primary");

        //         // append to the DOM
        //         $(".show-buttons").append(button);

        //         topics.push(input)

        //         // for each giphy result
        //         for (i = 0; i < results.length; i++) {

        //             // create a new div 
        //             var showDiv = $("<div>");

        //             // display the rating 
        //             var rating = $("<p>").text("Rating: " + results[i].rating)

        //             // create image tag
        //             var image = $("<img>")
        //             // drill down in obj and find the image URL
        //             var imgURL = results[i].images.original.url
        //             // set attribute
        //             var showImage = image.attr("src", imgURL)

        //             //append to the DOM

        //             showDiv.append(showImage)
        //             showDiv.append(rating)
        //             $(".show-gifs").prepend(showDiv)
        //         }
        //     })
        // })


    </script>
</body>

</html>